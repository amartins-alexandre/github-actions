name: Docker Image CI
on:
  workflow_call:
    inputs:
      project_version:
        required: true
        type: string
jobs:
    build:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v2

        - name: Docker Hub Login
          uses: docker/login-action@v2
          with:
            username: ${{ secrets.DOCKER_USERNAME }}
            password: ${{ secrets.DOCKER_PASSWORD }}

        - name: Build Docker Image
          uses: docker/build-push-action@v2
          with:
              context: .
              file: Dockerfile
              push: true
              tags: | 
                ${{ secrets.DOCKER_USERNAME }}/ktor-user:latest
                ${{ secrets.DOCKER_USERNAME }}/ktor-user:${{ project_version }}
